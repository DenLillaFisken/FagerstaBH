<link href="https://online.bookvisit.com/Util/GetConferenceCSS?channelId=56b734f3-8829-40af-927e-9f27f2cf7f37&amp;minify=True&amp;type=WidgetStandardWide&amp;bookingEngineLayout=NewWindow" rel="stylesheet" type="text/css" />

<form action='https://online.bookvisit.com/Cookie/CookieRedirect' id="ea-js-cookie-fix-form" method="POST">
    <input id="eaRedirectUrl" name="eaRedirectUrl" type="hidden" value="" />
</form>
<input class="bv-js-channelid" id="ChannelId" name="ChannelId" type="hidden" value="56b734f3-8829-40af-927e-9f27f2cf7f37" />

    <div class="bv-framework bv-widget">
        <div class="bv-widget-inner bv-standard bv-accommodation bv-property bv-with-extra ">
            <div class="bv-section">
                <div class="bv-section-inner bv-js-search-container">
<!-- date -->
<div class="bv-item bv-item-date bv-js-item-date">

    <input type="hidden" class="bv-js-stay-length" value="2" />
    <input type="hidden" class="bv-js-arrvial-date-year" value="2021" />
    <input type="hidden" class="bv-js-arrvial-date-month" value="5" />
    <input type="hidden" class="bv-js-arrvial-date-day" value="26" />
    <input type="hidden" class="bv-js-start-date" value="05/26/2021 00:00:00" />
    <input type="hidden" class="bv-js-end-date" value="05/28/2021 00:00:00" />

    <div class="bv-lbl-title">Ankomstdatum:</div>
    <label class="bv-gui-text bv-js-datepicker-input" style="cursor: pointer;">
        <span>V&#228;lj datum</span>
        <i class="bv-input-icn bv-icn-calendar"><i></i><i></i></i>
    </label>
    <div class="bv-dateboxes bv-js-datepicker-datebox" style="display: none;">
        <div>
            <div>
                <div class="bv-type">Incheckning</div>
                <div>
                    <div class="bv-placeholder bv-js-checkin-placeholder" style="display: none;">V&#228;lj datum</div>
                    <div class="bv-weekday bv-js-startweekday">onsdag</div>
                    <div class="bv-date bv-js-startdate">26</div>
                    <div class="bv-month bv-js-startmonth">maj</div>
                </div>
            </div>
            <div>
                <div class="bv-type">Utcheckning</div>
                <div>
                    <div class="bv-placeholder bv-js-checkout-placeholder" style="display: none;">V&#228;lj datum</div>
                    <div class="bv-weekday bv-js-endweekday">fredag</div>
                    <div class="bv-date bv-js-enddate">28</div>
                    <div class="bv-month bv-js-endmonth">maj</div>
                </div>
            </div>
        </div>
    </div>
    <div class="bv-datepicker-cnt bv-js-datepicker-overlay" style="display: none;">
        <div class="bv-datepicker bv-period-select bv-js-datepicker " style="display: block;">
            <div class="bv-datepicker-inner">
                <div class="bv-picker-title" style="display: none;">
                    <h3>V&#228;lj ankomstdatum</h3>
                    <div class="bv-close bv-js-datepicker-close">
                        <div class="bv-gui-btn">Klar</div>
                    </div>
                </div>
                <div class="bv-picker-overflow">
                    <div class="bv-datepicker-header">
                        <a class="bv-js-lnkprev bv-datepicker-prev bv-js-datepicker-prev" title="F&#246;reg&#229;ende">
                            F&#246;reg&#229;ende
                        </a>
                        <a class="bv-js-lnknext bv-datepicker-next bv-js-datepicker-next" title="N&#228;sta">
                            N&#228;sta
                        </a>
                        <div class="bv-datepicker-title">
                            <select class="bv-gui-select monthly bv-js-month-select">
                                    <option value="5:2021">Maj 2021</option>
                                    <option value="6:2021">Juni 2021</option>
                                    <option value="7:2021">Juli 2021</option>
                                    <option value="8:2021">Augusti 2021</option>
                                    <option value="9:2021">September 2021</option>
                                    <option value="10:2021">Oktober 2021</option>
                                    <option value="11:2021">November 2021</option>
                                    <option value="12:2021">December 2021</option>
                                    <option value="1:2022">Januari 2022</option>
                                    <option value="2:2022">Februari 2022</option>
                                    <option value="3:2022">Mars 2022</option>
                                    <option value="4:2022">April 2022</option>
                                    <option value="5:2022">Maj 2022</option>
                                    <option value="6:2022">Juni 2022</option>
                                    <option value="7:2022">Juli 2022</option>
                                    <option value="8:2022">Augusti 2022</option>
                                    <option value="9:2022">September 2022</option>
                                    <option value="10:2022">Oktober 2022</option>
                                    <option value="11:2022">November 2022</option>
                            </select>
                        </div>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th><span title="m&#229;ndag">m&#229;n</span></th>
                                <th><span title="tisdag">tis</span></th>
                                <th><span title="onsdag">ons</span></th>
                                <th><span title="torsdag">tor</span></th>
                                <th><span title="fredag">fre</span></th>
                                <th><span title="l&#246;rdag">l&#246;r</span></th>
                                <th><span title="s&#246;ndag">s&#246;n</span></th>
                            </tr>
                        </thead>
                        <tbody class="bv-js-calendar-table">
                        </tbody>
                    </table>

                    <div class="bv-txt-selected bv-js-search-info-container">
                        <div class="bv-js-search-info"></div>
                        <div style='display:none'>SEK</div>
                    </div>


                </div>
            </div>
        </div>

        <script>
            (function ($) {
                if ("False" === "True") {
                    $('#widgetContainer .bv-js-month-select').simpleSelect();
                }

                var monthNamesShort = ["jan","feb","mar","apr","maj","jun","jul","aug","sep","okt","nov","dec"];
                var stayLengthInDays = 'False' === "True";

                function nrDaysDisplay(nrNights, endDateString) {
                    if (stayLengthInDays) {
                        return nrNights + ' ' + (nrNights === 1 ? "dag"
                            : "dagar")  + (endDateString === null ? ""
                            :  ' (' + endDateString + ')');
                    }

                    return nrNights + ' ' + (nrNights === 1 ? "natt"
                        : "nätter")  + (endDateString === null ? ""
                        :  ' (' + endDateString + ')');
                }

                function getDateFormat(year, month, day) {
                    return year + '-' + month + '-' + day;
                }

                function renderCalendar(model) {

                    if (model.AllowedToMoveForward) {
                        $('#widgetContainer .bv-js-datepicker-next').removeClass("bv-dis");
                    } else {
                        $('#widgetContainer .bv-js-datepicker-next').addClass("bv-dis");
                    }

                    if (model.AllowedToMoveBackward) {
                        $('#widgetContainer .bv-js-datepicker-prev').removeClass("bv-dis");
                    } else {
                        $('#widgetContainer .bv-js-datepicker-prev').addClass("bv-dis");
                    }

                    var calendarTable =  $('#widgetContainer .bv-js-calendar-table');
                    var longerStayText = 'Fler n&#228;tter';

                    if (stayLengthInDays) {
                        longerStayText= 'Fler dagar';
                    }

                    for ( var i = 0; i < model.CalendarWeeks.length; i++) {
                        var currentWeek = model.CalendarWeeks[i];
                        var tr = $( '<tr class="bv-js-week">' );
                        for ( var j = 0; j < currentWeek.CalendarDays.length; j++) {
                            var currentDay = currentWeek.CalendarDays[j];
                            var td;
                            var tdHtml;
                            if (currentDay.ValidArrivalDate) {
                                tdHtml = '<td class="bv-js-day">';
                                tdHtml += '<a href="javascript:void(0);" class="bv-js-day-marker bv-js-day bv-js-clickable-day" data-weekdaylong="' +
                                    currentDay.WeekdayLong + '" data-daylong="' +
                                    currentDay.DayLong + '" data-monthlong="' +
                                    currentDay.MonthLong + '">';
                                tdHtml += '<input type="hidden" value="' + getDateFormat(currentDay.Year, currentDay.Month, currentDay.Day) + '" class="bv-js-date"/>';
                                tdHtml += '<span class="bv-date">' + currentDay.Day + '</span>';
                                if (currentDay.Price != null) {
                                    tdHtml += '<span class="bv-price">' + currentDay.Price + '</span>' ;
                                }
                                if (currentDay.ValidArrivalDateForSisterHotels) {
                                    tdHtml += '<span class="bv-calmarker-crosssale"></span>';
                                }
                                else if (currentDay.ValidArrivalDateForWaitingList) {
                                    tdHtml += '<span class="bv-calmarker-waitinglist"></span>';
                                }
                                tdHtml += '</a>';
                                tdHtml += '<div class="bv-stay-lenght bv-js-stay-lenght-container">';
                                tdHtml += '<ul>';
                                tdHtml += '<li class="bv-title">M&#246;jlig l&#228;ngd p&#229; vistelsen</li>';

                                var nrStayLengthToShow = 5;
                                if (currentDay.StayLengths.length < 5) {
                                    nrStayLengthToShow = currentDay.StayLengths.length;
                                }
                                var currentStayLength;
                                for ( var k = 0; k < nrStayLengthToShow; k++) {
                                    currentStayLength = currentDay.StayLengths[k];
                                    tdHtml += '<li>';
                                    tdHtml += '<a href="javascript:void(0);" class="bv-js-staylength" data-staylength="' + currentStayLength +
                                        '" data-weekdaylong="' + currentDay.DepartureDateWeekDayLong[k] +
                                        '" data-daylong="' + currentDay.DepartureDateDayLong[k] +
                                        '" data-monthlong="' + currentDay.DepartureDateMonthLong[k] + '">';
                                    tdHtml += nrDaysDisplay(currentStayLength, currentDay.DepartureDateDisplayStrings[k]);
                                    tdHtml += '</a>';
                                    tdHtml += '</li>';
                                }
                                if (currentDay.StayLengths.length > 5) {
                                     tdHtml += '<li>';
                                     tdHtml += '<div class="bv-gui-select"><span aria-hidden="true">' + longerStayText + '</span>';
                                     tdHtml += '<select class="bv-js-dd-staylengths">';
                                     tdHtml += '<option>' + longerStayText +'</option>';

                                    for ( var l = 5; l < currentDay.StayLengths.length; l++) {
                                        currentStayLength = currentDay.StayLengths[l];
                                        tdHtml += '<option value="' + currentStayLength +
                                            '" data-weekdaylong="' + currentDay.DepartureDateWeekDayLong[k] +
                                            '" data-daylong="' + currentDay.DepartureDateDayLong[k] +
                                            '" data-monthlong="' + currentDay.DepartureDateMonthLong[k] + '">' ;
                                        tdHtml += nrDaysDisplay(currentStayLength, currentDay.DepartureDateDisplayStrings[l]);
                                        tdHtml += '</option>';
                                    }

                                    tdHtml += '</select>';
                                    tdHtml += '</div>';
                                    tdHtml += '</li>';
                                }
                                tdHtml += '</ul>';
                                tdHtml += '</div>';
                                tdHtml += '</td>';
                            } else {
                                tdHtml = '<td class="bv-datepicker-other-month bv-js-day">' ;
                                tdHtml += '<span class="bv-js-day-marker"><span class="bv-date">' + currentDay.Day + '</span></span>';
                                tdHtml += '<input type="hidden" value="' + getDateFormat(currentDay.Year, currentDay.Month, currentDay.Day) + '" class="bv-js-date"/>';
                                tdHtml += '</td>';

                            }
                            td = $(tdHtml);
                            tr.append(td);
                        }

                        calendarTable.append(tr);
                    }

                    var monthYear = model.Month + ':' + model.Year;
                    $('#widgetContainer .bv-js-month-select').val(monthYear).change();
                };

                var calendarJson = {"CalendarWeeks":[{"CalendarDays":[{"ValidArrivalDate":false,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[],"Day":26,"Month":4,"Year":2021,"Price":null,"Date":"\/Date(1619388000000)\/","UseDayStayLength":false,"WeekdayLong":"måndag","DayLong":"26","MonthLong":"april","DepartureDateDisplayStrings":[],"DepartureDateWeekDayLong":[],"DepartureDateDayLong":[],"DepartureDateMonthLong":[]},{"ValidArrivalDate":false,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[],"Day":27,"Month":4,"Year":2021,"Price":null,"Date":"\/Date(1619474400000)\/","UseDayStayLength":false,"WeekdayLong":"tisdag","DayLong":"27","MonthLong":"april","DepartureDateDisplayStrings":[],"DepartureDateWeekDayLong":[],"DepartureDateDayLong":[],"DepartureDateMonthLong":[]},{"ValidArrivalDate":false,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[],"Day":28,"Month":4,"Year":2021,"Price":null,"Date":"\/Date(1619560800000)\/","UseDayStayLength":false,"WeekdayLong":"onsdag","DayLong":"28","MonthLong":"april","DepartureDateDisplayStrings":[],"DepartureDateWeekDayLong":[],"DepartureDateDayLong":[],"DepartureDateMonthLong":[]},{"ValidArrivalDate":false,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[],"Day":29,"Month":4,"Year":2021,"Price":null,"Date":"\/Date(1619647200000)\/","UseDayStayLength":false,"WeekdayLong":"torsdag","DayLong":"29","MonthLong":"april","DepartureDateDisplayStrings":[],"DepartureDateWeekDayLong":[],"DepartureDateDayLong":[],"DepartureDateMonthLong":[]},{"ValidArrivalDate":false,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[],"Day":30,"Month":4,"Year":2021,"Price":null,"Date":"\/Date(1619733600000)\/","UseDayStayLength":false,"WeekdayLong":"fredag","DayLong":"30","MonthLong":"april","DepartureDateDisplayStrings":[],"DepartureDateWeekDayLong":[],"DepartureDateDayLong":[],"DepartureDateMonthLong":[]},{"ValidArrivalDate":false,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[],"Day":1,"Month":5,"Year":2021,"Price":null,"Date":"\/Date(1619820000000)\/","UseDayStayLength":false,"WeekdayLong":"lördag","DayLong":"1","MonthLong":"maj","DepartureDateDisplayStrings":[],"DepartureDateWeekDayLong":[],"DepartureDateDayLong":[],"DepartureDateMonthLong":[]},{"ValidArrivalDate":false,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[],"Day":2,"Month":5,"Year":2021,"Price":null,"Date":"\/Date(1619906400000)\/","UseDayStayLength":false,"WeekdayLong":"söndag","DayLong":"2","MonthLong":"maj","DepartureDateDisplayStrings":[],"DepartureDateWeekDayLong":[],"DepartureDateDayLong":[],"DepartureDateMonthLong":[]}]},{"CalendarDays":[{"ValidArrivalDate":false,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[],"Day":3,"Month":5,"Year":2021,"Price":null,"Date":"\/Date(1619992800000)\/","UseDayStayLength":false,"WeekdayLong":"måndag","DayLong":"3","MonthLong":"maj","DepartureDateDisplayStrings":[],"DepartureDateWeekDayLong":[],"DepartureDateDayLong":[],"DepartureDateMonthLong":[]},{"ValidArrivalDate":false,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[],"Day":4,"Month":5,"Year":2021,"Price":null,"Date":"\/Date(1620079200000)\/","UseDayStayLength":false,"WeekdayLong":"tisdag","DayLong":"4","MonthLong":"maj","DepartureDateDisplayStrings":[],"DepartureDateWeekDayLong":[],"DepartureDateDayLong":[],"DepartureDateMonthLong":[]},{"ValidArrivalDate":false,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[],"Day":5,"Month":5,"Year":2021,"Price":null,"Date":"\/Date(1620165600000)\/","UseDayStayLength":false,"WeekdayLong":"onsdag","DayLong":"5","MonthLong":"maj","DepartureDateDisplayStrings":[],"DepartureDateWeekDayLong":[],"DepartureDateDayLong":[],"DepartureDateMonthLong":[]},{"ValidArrivalDate":false,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[],"Day":6,"Month":5,"Year":2021,"Price":null,"Date":"\/Date(1620252000000)\/","UseDayStayLength":false,"WeekdayLong":"torsdag","DayLong":"6","MonthLong":"maj","DepartureDateDisplayStrings":[],"DepartureDateWeekDayLong":[],"DepartureDateDayLong":[],"DepartureDateMonthLong":[]},{"ValidArrivalDate":false,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[],"Day":7,"Month":5,"Year":2021,"Price":null,"Date":"\/Date(1620338400000)\/","UseDayStayLength":false,"WeekdayLong":"fredag","DayLong":"7","MonthLong":"maj","DepartureDateDisplayStrings":[],"DepartureDateWeekDayLong":[],"DepartureDateDayLong":[],"DepartureDateMonthLong":[]},{"ValidArrivalDate":false,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[],"Day":8,"Month":5,"Year":2021,"Price":null,"Date":"\/Date(1620424800000)\/","UseDayStayLength":false,"WeekdayLong":"lördag","DayLong":"8","MonthLong":"maj","DepartureDateDisplayStrings":[],"DepartureDateWeekDayLong":[],"DepartureDateDayLong":[],"DepartureDateMonthLong":[]},{"ValidArrivalDate":false,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[],"Day":9,"Month":5,"Year":2021,"Price":null,"Date":"\/Date(1620511200000)\/","UseDayStayLength":false,"WeekdayLong":"söndag","DayLong":"9","MonthLong":"maj","DepartureDateDisplayStrings":[],"DepartureDateWeekDayLong":[],"DepartureDateDayLong":[],"DepartureDateMonthLong":[]}]},{"CalendarDays":[{"ValidArrivalDate":false,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[],"Day":10,"Month":5,"Year":2021,"Price":null,"Date":"\/Date(1620597600000)\/","UseDayStayLength":false,"WeekdayLong":"måndag","DayLong":"10","MonthLong":"maj","DepartureDateDisplayStrings":[],"DepartureDateWeekDayLong":[],"DepartureDateDayLong":[],"DepartureDateMonthLong":[]},{"ValidArrivalDate":false,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[],"Day":11,"Month":5,"Year":2021,"Price":null,"Date":"\/Date(1620684000000)\/","UseDayStayLength":false,"WeekdayLong":"tisdag","DayLong":"11","MonthLong":"maj","DepartureDateDisplayStrings":[],"DepartureDateWeekDayLong":[],"DepartureDateDayLong":[],"DepartureDateMonthLong":[]},{"ValidArrivalDate":false,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[],"Day":12,"Month":5,"Year":2021,"Price":null,"Date":"\/Date(1620770400000)\/","UseDayStayLength":false,"WeekdayLong":"onsdag","DayLong":"12","MonthLong":"maj","DepartureDateDisplayStrings":[],"DepartureDateWeekDayLong":[],"DepartureDateDayLong":[],"DepartureDateMonthLong":[]},{"ValidArrivalDate":false,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[],"Day":13,"Month":5,"Year":2021,"Price":null,"Date":"\/Date(1620856800000)\/","UseDayStayLength":false,"WeekdayLong":"torsdag","DayLong":"13","MonthLong":"maj","DepartureDateDisplayStrings":[],"DepartureDateWeekDayLong":[],"DepartureDateDayLong":[],"DepartureDateMonthLong":[]},{"ValidArrivalDate":false,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[],"Day":14,"Month":5,"Year":2021,"Price":null,"Date":"\/Date(1620943200000)\/","UseDayStayLength":false,"WeekdayLong":"fredag","DayLong":"14","MonthLong":"maj","DepartureDateDisplayStrings":[],"DepartureDateWeekDayLong":[],"DepartureDateDayLong":[],"DepartureDateMonthLong":[]},{"ValidArrivalDate":false,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[],"Day":15,"Month":5,"Year":2021,"Price":null,"Date":"\/Date(1621029600000)\/","UseDayStayLength":false,"WeekdayLong":"lördag","DayLong":"15","MonthLong":"maj","DepartureDateDisplayStrings":[],"DepartureDateWeekDayLong":[],"DepartureDateDayLong":[],"DepartureDateMonthLong":[]},{"ValidArrivalDate":false,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[],"Day":16,"Month":5,"Year":2021,"Price":null,"Date":"\/Date(1621116000000)\/","UseDayStayLength":false,"WeekdayLong":"söndag","DayLong":"16","MonthLong":"maj","DepartureDateDisplayStrings":[],"DepartureDateWeekDayLong":[],"DepartureDateDayLong":[],"DepartureDateMonthLong":[]}]},{"CalendarDays":[{"ValidArrivalDate":false,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[],"Day":17,"Month":5,"Year":2021,"Price":null,"Date":"\/Date(1621202400000)\/","UseDayStayLength":false,"WeekdayLong":"måndag","DayLong":"17","MonthLong":"maj","DepartureDateDisplayStrings":[],"DepartureDateWeekDayLong":[],"DepartureDateDayLong":[],"DepartureDateMonthLong":[]},{"ValidArrivalDate":false,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[],"Day":18,"Month":5,"Year":2021,"Price":null,"Date":"\/Date(1621288800000)\/","UseDayStayLength":false,"WeekdayLong":"tisdag","DayLong":"18","MonthLong":"maj","DepartureDateDisplayStrings":[],"DepartureDateWeekDayLong":[],"DepartureDateDayLong":[],"DepartureDateMonthLong":[]},{"ValidArrivalDate":false,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[],"Day":19,"Month":5,"Year":2021,"Price":null,"Date":"\/Date(1621375200000)\/","UseDayStayLength":false,"WeekdayLong":"onsdag","DayLong":"19","MonthLong":"maj","DepartureDateDisplayStrings":[],"DepartureDateWeekDayLong":[],"DepartureDateDayLong":[],"DepartureDateMonthLong":[]},{"ValidArrivalDate":false,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[],"Day":20,"Month":5,"Year":2021,"Price":null,"Date":"\/Date(1621461600000)\/","UseDayStayLength":false,"WeekdayLong":"torsdag","DayLong":"20","MonthLong":"maj","DepartureDateDisplayStrings":[],"DepartureDateWeekDayLong":[],"DepartureDateDayLong":[],"DepartureDateMonthLong":[]},{"ValidArrivalDate":false,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[],"Day":21,"Month":5,"Year":2021,"Price":null,"Date":"\/Date(1621548000000)\/","UseDayStayLength":false,"WeekdayLong":"fredag","DayLong":"21","MonthLong":"maj","DepartureDateDisplayStrings":[],"DepartureDateWeekDayLong":[],"DepartureDateDayLong":[],"DepartureDateMonthLong":[]},{"ValidArrivalDate":false,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[],"Day":22,"Month":5,"Year":2021,"Price":null,"Date":"\/Date(1621634400000)\/","UseDayStayLength":false,"WeekdayLong":"lördag","DayLong":"22","MonthLong":"maj","DepartureDateDisplayStrings":[],"DepartureDateWeekDayLong":[],"DepartureDateDayLong":[],"DepartureDateMonthLong":[]},{"ValidArrivalDate":false,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[],"Day":23,"Month":5,"Year":2021,"Price":null,"Date":"\/Date(1621720800000)\/","UseDayStayLength":false,"WeekdayLong":"söndag","DayLong":"23","MonthLong":"maj","DepartureDateDisplayStrings":[],"DepartureDateWeekDayLong":[],"DepartureDateDayLong":[],"DepartureDateMonthLong":[]}]},{"CalendarDays":[{"ValidArrivalDate":false,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[],"Day":24,"Month":5,"Year":2021,"Price":null,"Date":"\/Date(1621807200000)\/","UseDayStayLength":false,"WeekdayLong":"måndag","DayLong":"24","MonthLong":"maj","DepartureDateDisplayStrings":[],"DepartureDateWeekDayLong":[],"DepartureDateDayLong":[],"DepartureDateMonthLong":[]},{"ValidArrivalDate":false,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[],"Day":25,"Month":5,"Year":2021,"Price":null,"Date":"\/Date(1621893600000)\/","UseDayStayLength":false,"WeekdayLong":"tisdag","DayLong":"25","MonthLong":"maj","DepartureDateDisplayStrings":[],"DepartureDateWeekDayLong":[],"DepartureDateDayLong":[],"DepartureDateMonthLong":[]},{"ValidArrivalDate":true,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29],"Day":26,"Month":5,"Year":2021,"Price":null,"Date":"\/Date(1621980000000)\/","UseDayStayLength":false,"WeekdayLong":"onsdag","DayLong":"26","MonthLong":"maj","DepartureDateDisplayStrings":["tor 27 maj","fre 28 maj","lör 29 maj","sön 30 maj","mån 31 maj","tis 1 jun","ons 2 jun","tor 3 jun","fre 4 jun","lör 5 jun","sön 6 jun","mån 7 jun","tis 8 jun","ons 9 jun","tor 10 jun","fre 11 jun","lör 12 jun","sön 13 jun","mån 14 jun","tis 15 jun","ons 16 jun","tor 17 jun","fre 18 jun","lör 19 jun","sön 20 jun","mån 21 jun","tis 22 jun","ons 23 jun","tor 24 jun"],"DepartureDateWeekDayLong":["torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag"],"DepartureDateDayLong":["27","28","29","30","31","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],"DepartureDateMonthLong":["maj","maj","maj","maj","maj","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni"]},{"ValidArrivalDate":true,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28],"Day":27,"Month":5,"Year":2021,"Price":null,"Date":"\/Date(1622066400000)\/","UseDayStayLength":false,"WeekdayLong":"torsdag","DayLong":"27","MonthLong":"maj","DepartureDateDisplayStrings":["fre 28 maj","lör 29 maj","sön 30 maj","mån 31 maj","tis 1 jun","ons 2 jun","tor 3 jun","fre 4 jun","lör 5 jun","sön 6 jun","mån 7 jun","tis 8 jun","ons 9 jun","tor 10 jun","fre 11 jun","lör 12 jun","sön 13 jun","mån 14 jun","tis 15 jun","ons 16 jun","tor 17 jun","fre 18 jun","lör 19 jun","sön 20 jun","mån 21 jun","tis 22 jun","ons 23 jun","tor 24 jun"],"DepartureDateWeekDayLong":["fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag"],"DepartureDateDayLong":["28","29","30","31","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],"DepartureDateMonthLong":["maj","maj","maj","maj","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni"]},{"ValidArrivalDate":true,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27],"Day":28,"Month":5,"Year":2021,"Price":null,"Date":"\/Date(1622152800000)\/","UseDayStayLength":false,"WeekdayLong":"fredag","DayLong":"28","MonthLong":"maj","DepartureDateDisplayStrings":["lör 29 maj","sön 30 maj","mån 31 maj","tis 1 jun","ons 2 jun","tor 3 jun","fre 4 jun","lör 5 jun","sön 6 jun","mån 7 jun","tis 8 jun","ons 9 jun","tor 10 jun","fre 11 jun","lör 12 jun","sön 13 jun","mån 14 jun","tis 15 jun","ons 16 jun","tor 17 jun","fre 18 jun","lör 19 jun","sön 20 jun","mån 21 jun","tis 22 jun","ons 23 jun","tor 24 jun"],"DepartureDateWeekDayLong":["lördag","söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag"],"DepartureDateDayLong":["29","30","31","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],"DepartureDateMonthLong":["maj","maj","maj","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni"]},{"ValidArrivalDate":true,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26],"Day":29,"Month":5,"Year":2021,"Price":null,"Date":"\/Date(1622239200000)\/","UseDayStayLength":false,"WeekdayLong":"lördag","DayLong":"29","MonthLong":"maj","DepartureDateDisplayStrings":["sön 30 maj","mån 31 maj","tis 1 jun","ons 2 jun","tor 3 jun","fre 4 jun","lör 5 jun","sön 6 jun","mån 7 jun","tis 8 jun","ons 9 jun","tor 10 jun","fre 11 jun","lör 12 jun","sön 13 jun","mån 14 jun","tis 15 jun","ons 16 jun","tor 17 jun","fre 18 jun","lör 19 jun","sön 20 jun","mån 21 jun","tis 22 jun","ons 23 jun","tor 24 jun"],"DepartureDateWeekDayLong":["söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag"],"DepartureDateDayLong":["30","31","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],"DepartureDateMonthLong":["maj","maj","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni"]},{"ValidArrivalDate":true,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25],"Day":30,"Month":5,"Year":2021,"Price":null,"Date":"\/Date(1622325600000)\/","UseDayStayLength":false,"WeekdayLong":"söndag","DayLong":"30","MonthLong":"maj","DepartureDateDisplayStrings":["mån 31 maj","tis 1 jun","ons 2 jun","tor 3 jun","fre 4 jun","lör 5 jun","sön 6 jun","mån 7 jun","tis 8 jun","ons 9 jun","tor 10 jun","fre 11 jun","lör 12 jun","sön 13 jun","mån 14 jun","tis 15 jun","ons 16 jun","tor 17 jun","fre 18 jun","lör 19 jun","sön 20 jun","mån 21 jun","tis 22 jun","ons 23 jun","tor 24 jun"],"DepartureDateWeekDayLong":["måndag","tisdag","onsdag","torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag"],"DepartureDateDayLong":["31","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],"DepartureDateMonthLong":["maj","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni"]}]},{"CalendarDays":[{"ValidArrivalDate":true,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"Day":31,"Month":5,"Year":2021,"Price":null,"Date":"\/Date(1622412000000)\/","UseDayStayLength":false,"WeekdayLong":"måndag","DayLong":"31","MonthLong":"maj","DepartureDateDisplayStrings":["tis 1 jun","ons 2 jun","tor 3 jun","fre 4 jun","lör 5 jun","sön 6 jun","mån 7 jun","tis 8 jun","ons 9 jun","tor 10 jun","fre 11 jun","lör 12 jun","sön 13 jun","mån 14 jun","tis 15 jun","ons 16 jun","tor 17 jun","fre 18 jun","lör 19 jun","sön 20 jun","mån 21 jun","tis 22 jun","ons 23 jun","tor 24 jun"],"DepartureDateWeekDayLong":["tisdag","onsdag","torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag"],"DepartureDateDayLong":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],"DepartureDateMonthLong":["juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni"]},{"ValidArrivalDate":true,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"Day":1,"Month":6,"Year":2021,"Price":null,"Date":"\/Date(1622498400000)\/","UseDayStayLength":false,"WeekdayLong":"tisdag","DayLong":"1","MonthLong":"juni","DepartureDateDisplayStrings":["ons 2 jun","tor 3 jun","fre 4 jun","lör 5 jun","sön 6 jun","mån 7 jun","tis 8 jun","ons 9 jun","tor 10 jun","fre 11 jun","lör 12 jun","sön 13 jun","mån 14 jun","tis 15 jun","ons 16 jun","tor 17 jun","fre 18 jun","lör 19 jun","sön 20 jun","mån 21 jun","tis 22 jun","ons 23 jun","tor 24 jun"],"DepartureDateWeekDayLong":["onsdag","torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag"],"DepartureDateDayLong":["2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],"DepartureDateMonthLong":["juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni"]},{"ValidArrivalDate":true,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22],"Day":2,"Month":6,"Year":2021,"Price":null,"Date":"\/Date(1622584800000)\/","UseDayStayLength":false,"WeekdayLong":"onsdag","DayLong":"2","MonthLong":"juni","DepartureDateDisplayStrings":["tor 3 jun","fre 4 jun","lör 5 jun","sön 6 jun","mån 7 jun","tis 8 jun","ons 9 jun","tor 10 jun","fre 11 jun","lör 12 jun","sön 13 jun","mån 14 jun","tis 15 jun","ons 16 jun","tor 17 jun","fre 18 jun","lör 19 jun","sön 20 jun","mån 21 jun","tis 22 jun","ons 23 jun","tor 24 jun"],"DepartureDateWeekDayLong":["torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag"],"DepartureDateDayLong":["3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],"DepartureDateMonthLong":["juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni"]},{"ValidArrivalDate":true,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21],"Day":3,"Month":6,"Year":2021,"Price":null,"Date":"\/Date(1622671200000)\/","UseDayStayLength":false,"WeekdayLong":"torsdag","DayLong":"3","MonthLong":"juni","DepartureDateDisplayStrings":["fre 4 jun","lör 5 jun","sön 6 jun","mån 7 jun","tis 8 jun","ons 9 jun","tor 10 jun","fre 11 jun","lör 12 jun","sön 13 jun","mån 14 jun","tis 15 jun","ons 16 jun","tor 17 jun","fre 18 jun","lör 19 jun","sön 20 jun","mån 21 jun","tis 22 jun","ons 23 jun","tor 24 jun"],"DepartureDateWeekDayLong":["fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag"],"DepartureDateDayLong":["4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],"DepartureDateMonthLong":["juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni"]},{"ValidArrivalDate":true,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"Day":4,"Month":6,"Year":2021,"Price":null,"Date":"\/Date(1622757600000)\/","UseDayStayLength":false,"WeekdayLong":"fredag","DayLong":"4","MonthLong":"juni","DepartureDateDisplayStrings":["lör 5 jun","sön 6 jun","mån 7 jun","tis 8 jun","ons 9 jun","tor 10 jun","fre 11 jun","lör 12 jun","sön 13 jun","mån 14 jun","tis 15 jun","ons 16 jun","tor 17 jun","fre 18 jun","lör 19 jun","sön 20 jun","mån 21 jun","tis 22 jun","ons 23 jun","tor 24 jun"],"DepartureDateWeekDayLong":["lördag","söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag"],"DepartureDateDayLong":["5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],"DepartureDateMonthLong":["juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni"]},{"ValidArrivalDate":true,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19],"Day":5,"Month":6,"Year":2021,"Price":null,"Date":"\/Date(1622844000000)\/","UseDayStayLength":false,"WeekdayLong":"lördag","DayLong":"5","MonthLong":"juni","DepartureDateDisplayStrings":["sön 6 jun","mån 7 jun","tis 8 jun","ons 9 jun","tor 10 jun","fre 11 jun","lör 12 jun","sön 13 jun","mån 14 jun","tis 15 jun","ons 16 jun","tor 17 jun","fre 18 jun","lör 19 jun","sön 20 jun","mån 21 jun","tis 22 jun","ons 23 jun","tor 24 jun"],"DepartureDateWeekDayLong":["söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag"],"DepartureDateDayLong":["6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],"DepartureDateMonthLong":["juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni"]},{"ValidArrivalDate":true,"ValidArrivalDateForWaitingList":false,"ValidArrivalDateForSisterHotels":false,"StayLengths":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18],"Day":6,"Month":6,"Year":2021,"Price":null,"Date":"\/Date(1622930400000)\/","UseDayStayLength":false,"WeekdayLong":"söndag","DayLong":"6","MonthLong":"juni","DepartureDateDisplayStrings":["mån 7 jun","tis 8 jun","ons 9 jun","tor 10 jun","fre 11 jun","lör 12 jun","sön 13 jun","mån 14 jun","tis 15 jun","ons 16 jun","tor 17 jun","fre 18 jun","lör 19 jun","sön 20 jun","mån 21 jun","tis 22 jun","ons 23 jun","tor 24 jun"],"DepartureDateWeekDayLong":["måndag","tisdag","onsdag","torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag","söndag","måndag","tisdag","onsdag","torsdag"],"DepartureDateDayLong":["7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],"DepartureDateMonthLong":["juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni","juni"]}]}],"Month":5,"Year":2021,"MonthName":"maj 2021","AllowedToMoveForward":true,"AllowedToMoveBackward":false,"CurrencyCode":null,"HasPopulatedPrices":false,"MaxDate":"\/Date(1669453396674)\/","BackOfficeSearch":false,"MonthOptions":null};
                renderCalendar(calendarJson);

                var currentCalendarMonth = calendarJson.Month;
                var currentCalendarYear = calendarJson.Year;

                $(document).on( "click", '#widgetContainer .bv-datepicker td:not(.bv-datepicker-other-month) > .bv-js-day-marker' , function() {
                    $('#widgetContainer .bv-datepicker td > .bv-js-day-marker').removeClass( "bv-state-active");
                    $('#widgetContainer .bv-datepicker td > .bv-js-day-marker').removeClass( "bv-state-departure");
                    $('#widgetContainer .bv-js-stay-lenght-container').hide();
                    $(this).addClass("bv-state-active");
                    $(this).siblings(".bv-js-stay-lenght-container").show();
                });

                function markDaysReverse(endColumnElem) {
                    if (!endColumnElem.hasClass('bv-state-active')) {
                        endColumnElem.addClass('bv-state-active');
                    }

                    var endToMark = endColumnElem.find('.bv-js-day-marker');

                    if (!endToMark.hasClass('bv-state-departure')) {
                        endToMark.addClass('bv-state-departure');
                    }

                    var lastMarkedColumn = endColumnElem;
                    var lastRow = endColumnElem.closest('.bv-js-week');

                    var elemToMark;
                    while ( true) {
                        lastMarkedColumn = lastMarkedColumn.prev();

                        elemToMark = lastMarkedColumn.find('.bv-js-day-marker');

                        if (lastMarkedColumn.length > 0) {
                            elemToMark.addClass('bv-state-active');
                        } else {
                            lastRow = lastRow.prev();
                            lastMarkedColumn = lastRow.find('.bv-js-day').last();

                            if (lastMarkedColumn.length > 0) {
                                elemToMark = lastMarkedColumn.find('.bv-js-day-marker' );
                                elemToMark.addClass('bv-state-active');
                            } else {
                                break;
                            }
                        }
                    }
                }

                function markDays(nrNights, startColumnElem) {
                    // Clear previous selection
                    $('.bv-state-active').each(function() {
                        $(this).removeClass('bv-state-active');
                    });

                    if (!startColumnElem.find('.bv-js-day-marker' ).hasClass('bv-state-active')) {
                        startColumnElem.find('.bv-js-day-marker' ).addClass('bv-state-active');
                    }

                    var lastMarkedColumn = startColumnElem;
                    var columnToMark = startColumnElem;
                    var elemToMark;
                    var lastRow = startColumnElem.closest('.bv-js-week');
                    for ( var i = 0; i < nrNights; i++) {
                        columnToMark = columnToMark.next();
                        elemToMark = columnToMark.find('.bv-js-day-marker');

                        if (columnToMark.length > 0 && columnToMark.is('h4')) {
                            columnToMark = columnToMark.next();
                        }
                        if (columnToMark.length > 0) {
                            elemToMark.addClass('bv-state-active');
                            lastMarkedColumn = columnToMark;
                        } else {
                            lastRow = lastRow.next();

                            columnToMark = lastRow.find('.bv-js-day').first();

                            if (columnToMark.length > 0) {
                                elemToMark = columnToMark.find('.bv-js-day-marker');
                                elemToMark.addClass('bv-state-active');
                                lastMarkedColumn = columnToMark;
                            } else {
                                break;
                            }
                        }
                    }

                    if (stayLengthInDays) {
                        lastMarkedColumn.find('.bv-js-day-marker').removeClass('bv-state-active');
                    } else {
                        lastMarkedColumn.find('.bv-js-day-marker').addClass('bv-state-departure');

                    }

                    var startDate = startColumnElem.find('.bv-js-date').val().split('-');
                    var startYear = startDate[0];
                    var startMonth = startDate[1];
                    var startDay = startDate[2];

                    var endMonth = startMonth;
                    var endDay = startDay;
                    if (lastMarkedColumn.find('.bv-js-date').val() != undefined) {
                        var endDate = lastMarkedColumn.find('.bv-js-date').val().split('-');
                        endMonth = endDate[1];
                        endDay = endDate[2];
                    }

                    var jsDate = new Date(parseInt(startYear), parseInt(startMonth) - 1, parseInt(startDay));
                    jsDate.setDate(jsDate.getDate() + parseInt(nrNights));

                    if (jsDate.getMonth() + 1 !== parseInt(endMonth) || jsDate.getDate() !== parseInt(endDay)) {
                        lastMarkedColumn.find('.bv-js-day-marker').removeClass('bv-state-departure').addClass( 'bv-state-active');
                    }

                    var startMonthName = monthNamesShort[startMonth-1];
                    var endMonthName = monthNamesShort[jsDate.getMonth()];

                    var display = startDay + ' ' + startMonthName + ' - ' + jsDate.getDate() + ' ' + endMonthName + ', ' + nrDaysDisplay(nrNights, null);

                    $('#widgetContainer .bv-js-search-info').html(display);
                    $('#widgetContainer .bv-js-search-info-full').html(display);
                    $('#widgetContainer .bv-js-search-info-container').show();
                    $('#widgetContainer .bv-js-staytimechoice').text(display);
                }

                function changeDateRange(startDate, endDate) {
                    if (!startDate) {
                        return;
                    }
                    var startDateValue = startDate.getFullYear() + "-" + (startDate.getMonth() + 1) + "-" + startDate.getDate();
                    var dateColumns = $('#widgetContainer' + " .bv-js-date[value='" + startDateValue + "']");

                    var dateColumn = dateColumns.length ? dateColumns[0] : null;
                    if (dateColumn == null) {
                        return;
                    }

                    var numberOfNights = 1;
                    if (endDate) {
                        var oneDay = 24 * 60 * 60 * 1000;
                        numberOfNights = Math.round(Math.abs((endDate.getTime() - startDate.getTime()) / (oneDay)));
                    }

                    var column = $(dateColumn).parent().parent();

                    if (column.length < 1) {
                        return;
                    }

                    changeDate({ stopPropagation: function() {} }, column[0], numberOfNights);
                }

                function changeDate(event, elem, nrNights) {
                    var column = $(elem).closest('.bv-js-day');

                    var date = column.find('.bv-js-date').val();

                    if (date == null) {
                        return;
                    }

                    var res = date.split("-");
                    var year = res[0];
                    var month = res[1];
                    var day = res[2];
                    $('#widgetContainer .bv-js-arrvial-date-year').val(year);
                    $('#widgetContainer .bv-js-arrvial-date-month').val(month);
                    $('#widgetContainer .bv-js-arrvial-date-day').val(day);

                    $('#widgetContainer .bv-js-stay-length').val(nrNights);

                    var startMonthName = monthNamesShort[month - 1];
                    var datestring = day + " " + startMonthName + " " + year;

                    $('#widgetContainer .bv-js-datepicker-input').find('span').text(datestring);

                    markDays(nrNights, column);

                    $('#widgetContainer .bv-js-stay-lenght-container').hide();

                    //Update plate dates data
                    var clickableStartDate = column.find('.bv-js-clickable-day');
                    var startWeekDayString = clickableStartDate.data("weekdaylong");
                    var startDayString = clickableStartDate.data("daylong");
                    var startMonthString = clickableStartDate.data("monthlong");

                    var endWeekDatString;
                    var endDayString;
                    var endMonthString;
                    if ($(elem).is("select")) {
                        var selectedOption = $(this).find(':selected');
                        endWeekDatString = selectedOption.data("weekdaylong");
                        endDayString = selectedOption.data("daylong");
                        endMonthString = selectedOption.data("monthlong");
                    }
                    else {
                        endWeekDatString = $(elem).data("weekdaylong");
                        endDayString = $(elem).data("daylong");
                        endMonthString = $(elem).data("monthlong");
                    }
                    var closeDatePicker = $(elem).closest(".bv-js-item-date");

                    var closeDatePlate = closeDatePicker.find(".bv-js-datepicker-datebox");
                    closeDatePlate.find(".bv-js-startweekday").text(startWeekDayString);
                    closeDatePlate.find(".bv-js-startdate").text(startDayString);
                    closeDatePlate.find(".bv-js-startmonth").text(startMonthString);
                    closeDatePlate.find(".bv-js-endweekday").text(endWeekDatString);
                    closeDatePlate.find(".bv-js-enddate").text(endDayString);
                    closeDatePlate.find(".bv-js-endmonth").text(endMonthString);

                    closeDatePlate.find(".bv-js-checkin-placeholder").hide();
                    closeDatePlate.find(".bv-js-checkout-placeholder").hide();
                    event.stopPropagation();
                }

                function calendarMarker() {

                    var year = $('#widgetContainer .bv-js-arrvial-date-year').val();
                    var month = $('#widgetContainer .bv-js-arrvial-date-month').val();
                    var day = $('#widgetContainer .bv-js-arrvial-date-day').val();
                    var numberOfNights = $('#widgetContainer .bv-js-stay-length').val();

                    if (year != undefined && month != undefined && day != undefined && numberOfNights != undefined) {

                        var startDate = getDateFormat(year, month, day);

                        if (startDate.length > 0 && numberOfNights.length > 0) {

                            var startInputElem = $('#widgetContainer .bv-js-date' + '[value="' + startDate + '"]');

                            if (startInputElem.length > 0) {
                                var startColumnElem = startInputElem.closest('.bv-js-day');
                                markDays(parseInt(numberOfNights), startColumnElem);
                            } else {

                                var endDate = new Date(year, parseInt(month) - 1, day);
                                endDate.setDate(endDate.getDate() + parseInt(numberOfNights));
                                var endDateString = getDateFormat(endDate.getFullYear(), endDate.getMonth() + 1, endDate.getDate());

                                if (endDateString.length > 0) {
                                    var endInputElem = $('#widgetContainer .bv-js-date' + '[value="' + endDateString + '"]');

                                    if (endInputElem.length > 0) {
                                        var endColumnElem = endInputElem.closest('.bv-js-day');
                                        markDaysReverse(endColumnElem);
                                    }
                                }
                            }
                        }
                    }
                }
                calendarMarker();

                var currentlySwitchingMonth = false;
                function changeCalendarMonth(year, month) {
                    currentlySwitchingMonth = true;

                    var channelId = '56b734f3-8829-40af-927e-9f27f2cf7f37';
                    var noRestrictions= '';
                    var packageId = '';
                    var packageCategoryId = '';
                    var roomId = '';
                    var campaignId = '';
                    var allPackages = 'False';
                    var isMultiPropertyPackageCategory = '';
                    var stayLengthInDays = "False" === "True" ? "true" : "false";

                    var baseUrl = 'https://online.bookvisit.com/v2/Widget/GetCalendarJsonP';
                    var url = baseUrl + "?channelId=" + channelId + "&year=" + year + "&month=" + month + "&packageId=" + packageId + "&packageCategoryId=" + packageCategoryId + "&roomId=" + roomId + "&campaignId=" + campaignId + "&noRestrictions=" + noRestrictions
                        + "&allPackages=" + allPackages + "&isMultiPropertyPackageCategory=" + isMultiPropertyPackageCategory + "&stayLengthInDays=" + stayLengthInDays;
                    url = url + '&jsoncallback=?';

                    $.getJSON(url,
                        function (data) {
                            if (data.ErrorMessage != null) {
                                alert($.htmlDecode("Ett fel uppstod d&#229; kalendern laddades " + " " + data.ErrorMessage));
                            } else {
                                $( '#widgetContainer .bv-js-calendar-table').empty();
                                renderCalendar(data.Calendar);
                                calendarMarker();
                            }
                            currentlySwitchingMonth = false;
                        });
                }

                $('#widgetContainer .bv-js-datepicker-prev').click(function () {
                    if (currentlySwitchingMonth) {
                        return;
                    }

                    if ($( this).hasClass('bv-dis')) {
                        return;
                    }

                    if (currentCalendarMonth === 1) {
                        currentCalendarYear = currentCalendarYear - 1;
                        currentCalendarMonth = 12;
                    } else {
                        currentCalendarMonth = currentCalendarMonth - 1;
                    }

                    changeCalendarMonth(currentCalendarYear, currentCalendarMonth);
                });

                $('#widgetContainer .bv-js-datepicker-next').click(function () {

                    if (currentlySwitchingMonth) {
                        return;
                    }

                    if ($(this).hasClass('bv-dis')) {
                        return;
                    }

                    if (currentCalendarMonth === 12) {
                        currentCalendarYear = currentCalendarYear + 1;
                        currentCalendarMonth = 1;
                    } else {
                        currentCalendarMonth = currentCalendarMonth + 1;
                    }

                    changeCalendarMonth(currentCalendarYear, currentCalendarMonth);
                });

                $('#widgetContainer .bv-js-month-select').change(function (){
                    if (currentlySwitchingMonth) {
                        return;
                    }

                    var monthYear = $(this).val().split(':');
                    currentCalendarMonth = parseInt(monthYear[0]);
                    currentCalendarYear = parseInt(monthYear[1]);
                    changeCalendarMonth(currentCalendarYear, currentCalendarMonth);
                });

                //clicking a stay length anchor in the popup
                $(document).on('click', '#widgetContainer .bv-js-staylength', function (e) {
                    var nrNights = $(this).data('staylength');
                    changeDate(e, $(this), nrNights);
                    if ($('#widgetContainer .bv-js-datepicker-close').is(':visible')) {
                        $('#widgetContainer .bv-js-datepicker-overlay').hide();
                    }
                });

                //clicking a stay length using drop-down in the popup
                $(document).on('change', '#widgetContainer .bv-js-dd-staylengths' , function (e) {
                    var nrNights = parseInt($( this).find(':selected').val());
                    changeDate(e, $( this), nrNights);
                    if ($('#widgetContainer .bv-js-datepicker-close').is(':visible')) {
                        $('#widgetContainer .bv-js-datepicker-overlay').hide();
                    }
                });

                $(document).mouseup(function (e) {
                    var container = $('#widgetContainer .bv-js-stay-lenght-container:visible');
                    if (!container.is(e.target) && container.has(e.target).length === 0) {
                        var stayLength = container.find('.bv-js-staylength').first();
                        if (stayLength.length > 0) {
                            var nrNights = $(stayLength).data('staylength');
                            changeDate(e, $(stayLength), nrNights);
                        }

                        container.hide();
                    }

                    var datepickerContainer = $('#widgetContainer .bv-js-datepicker-overlay');

                    $('#widgetContainer .bv-js-datepicker-input').on("click", function (el) {
                        datepickerContainer.show();
                        $("html").addClass("bv-widget-noscroll-small-device");
                    });

                    if (!datepickerContainer.is(e.target) && datepickerContainer.has(e.target).length === 0) {
                        datepickerContainer.hide();
                        var guestPickerContainer = $('#widgetContainer .bv-js-guestpicker-overlay');
                        var codeContainer = $('#widgetContainer .bv-js-codepicker-overlay');
                        if ((typeof guestPickerContainer === 'undefined' || guestPickerContainer.css('display') === 'none') &&
                            (typeof codeContainer === 'undefined' || codeContainer.css('display') === 'none')) {
                            $("html").removeClass("bv-widget-noscroll-small-device");
                        }
                    }
                });


                $(document).on("click", '#widgetContainer .bv-js-datepicker-close', function () {
                    $('#widgetContainer .bv-js-datepicker-overlay').hide();
                    $("html").removeClass("bv-widget-noscroll-small-device");
                });

                $(document).on("click", '#widgetContainer .bv-js-datepicker-datebox', function () {
                    $(this).hide();
                    $(this).closest(".bv-js-item-date").find('.bv-js-datepicker-overlay').show();
                    $("html").addClass("bv-widget-noscroll-small-device");
                });

                var initializeFromParameters = function() {
                    var startDate = $('#widgetContainer .bv-js-start-date').val();
                    var endDate = $('#widgetContainer .bv-js-end-date').val();

                    if (startDate) {
                        startDate = new Date(startDate.substr(0, 10));
                        endDate = endDate ? new Date(endDate.substr(0, 10)) : null;

                        changeDateRange(startDate, endDate);
                    }
                };
                initializeFromParameters();
            })(bvJQuery);
        </script>

    </div>

</div><input type="hidden" value="boende" class="bv-js-room" />
<input type="hidden" value="boenden" class="bv-js-rooms" />
<input type="hidden" value="g&#228;st" class="bv-js-guest" />
<input type="hidden" value="g&#228;ster" class="bv-js-guests" />
<input type="hidden" value="vuxen" class="bv-js-adult-text" />
<input type="hidden" value="vuxna" class="bv-js-adults-text" />
<input type="hidden" value="barn" class="bv-js-child-text" />
<input type="hidden" value="barn" class="bv-js-children-text" />
<input type="hidden" value="3" class="bv-js-max-number-adults" />
<input type="hidden" value="1" class="bv-js-min-number-adults" />
<input type="hidden" value="2" class="bv-js-max-number-children" />
<input type="hidden" class="bv-js-children-year-span" />
<input type="hidden" class="bv-js-sharer-max-age" />
<input type="hidden" value="2" class="bv-js-default-nr-adults" />
<input type="hidden" value="False" id="bv-for-single-room" />

<!-- guests -->
<div class="bv-item bv-item-guests">
    <div class="bv-lbl-title">V&#228;lj antal rum och g&#228;ster:</div>
    <label class="bv-gui-select bv-js-guestpicker-input" style="cursor: pointer;">
        <span class="bv-js-guestsummary">
            1 rum, 2 g&#228;ster
        </span>
    </label>
    <div class="bv-guestpicker-cnt bv-js-guestpicker-overlay" style="display: none;">
        <div class="bv-guestpicker" style="display: block;">
            <div class="bv-guestpicker-inner">
                <div class="bv-picker-title">
                    <h3>
                        <span>
V&#228;lj antal rum och g&#228;ster                        </span>
                        <span>Rum och g&#228;ster</span>
                    </h3>
                    <div class="bv-close bv-js-guestpicker-close">
                        <div class="bv-gui-btn">Klar</div>
                    </div>
                </div>
                <div class="bv-picker-overflow">
                        <div class="bv-item bv_js_roomconfig">
                            <div class="bv-lbl-title">
                                <span class="bv-js-room-no" style="">Rum 1:</span>
                                <a href="javascript: void(0);" class="bv-remove bv-js-remove" style="display: none;">
                                    <span class="bv-spin-icn bv-close"></span>
                                    Ta bort
                                </a>
                            </div>
                            <label class="bv-gui-text bv-js-change-guests" style="display: none">
                                <span class="bv-js-conf-summary">2 vuxna, 0 barn</span>
                                <i class="bv-input-icn bv-icn-pen"><i></i><i></i></i>
                            </label>
                            <div class="bv-guestgroup bv-js-guestgroup">
                                <div class="bv-picker bv-js-adults">
                                    <span class="bv-js-selected-adults">2 vuxna</span>
                                    <input class="bv-js-SelectedNrAdults" data-val="true" data-val-number="The field SelectedNrAdults must be a number." data-val-regex="Måste vara en siffra" data-val-regex-pattern="^-?\d+$" id="GuestPicker_RoomConfigurations_0__SelectedNrAdults" name="GuestPicker.RoomConfigurations[0].SelectedNrAdults" type="hidden" value="2" />
                                    <span class="bv-remove bv-js-adult-remove "><span class="bv-spin-icn bv-minus"></span></span>
                                    <span class="bv-add bv-js-adult-add "><span class="bv-spin-icn bv-plus"></span></span>
                                </div>
                                <div class="bv-picker">
                                    <span class="bv-js-selected-children">Inga barn</span>
                                    <input class="bv-js-SelectedNrChildren" data-val="true" data-val-number="The field SelectedNrChildren must be a number." data-val-regex="Måste vara en siffra" data-val-regex-pattern="^-?\d+$" id="GuestPicker_RoomConfigurations_0__SelectedNrChildren" name="GuestPicker.RoomConfigurations[0].SelectedNrChildren" type="hidden" value="0" />
                                    <span class="bv-remove bv-js-child-remove bv-dis"><span class="bv-spin-icn bv-minus"></span></span>
                                    <span class="bv-add bv-js-child-add "><span class="bv-spin-icn bv-plus"></span></span>
                                </div>
                                    <div class="bv-ages bv-js-childages" style='display:none;'>
                                        <span>Barn&#229;ldrar:</span>
<select class="bv-gui-select bv-js-childAge" data-val="true" data-val-number="The field Age must be a number." data-val-regex="Måste vara en siffra" data-val-regex-pattern="^-?\d+$" data-val-required="Obligatorisk" id="GuestPicker_RoomConfigurations_0__ChildAges_0__Age" name="GuestPicker.RoomConfigurations[0].ChildAges[0].Age"><option value="">V&#228;lj</option>
<option value="0">0 &#229;r</option>
<option value="1">1 &#229;r</option>
<option value="2">2 &#229;r</option>
<option value="3">3 &#229;r</option>
<option value="4">4 &#229;r</option>
<option value="5">5 &#229;r</option>
<option value="6">6 &#229;r</option>
<option value="7">7 &#229;r</option>
<option value="8">8 &#229;r</option>
<option value="9">9 &#229;r</option>
<option value="10">10 &#229;r</option>
<option value="11">11 &#229;r</option>
<option value="12">12 &#229;r</option>
<option value="13">13 &#229;r</option>
<option value="14">14 &#229;r</option>
<option value="15">15 &#229;r</option>
<option value="16">16 &#229;r</option>
<option value="17">17 &#229;r</option>
</select><select class="bv-gui-select bv-js-childAge" data-val="true" data-val-number="The field Age must be a number." data-val-regex="Måste vara en siffra" data-val-regex-pattern="^-?\d+$" data-val-required="Obligatorisk" id="GuestPicker_RoomConfigurations_0__ChildAges_1__Age" name="GuestPicker.RoomConfigurations[0].ChildAges[1].Age"><option value="">V&#228;lj</option>
<option value="0">0 &#229;r</option>
<option value="1">1 &#229;r</option>
<option value="2">2 &#229;r</option>
<option value="3">3 &#229;r</option>
<option value="4">4 &#229;r</option>
<option value="5">5 &#229;r</option>
<option value="6">6 &#229;r</option>
<option value="7">7 &#229;r</option>
<option value="8">8 &#229;r</option>
<option value="9">9 &#229;r</option>
<option value="10">10 &#229;r</option>
<option value="11">11 &#229;r</option>
<option value="12">12 &#229;r</option>
<option value="13">13 &#229;r</option>
<option value="14">14 &#229;r</option>
<option value="15">15 &#229;r</option>
<option value="16">16 &#229;r</option>
<option value="17">17 &#229;r</option>
</select>                                    </div>
                            </div>
                        </div>
                    <div class="bv-item bv-item-add" style="">
                        <a href="javascript: void(0);" class="bv-js-add-room">
                            <span class="bv-spin-icn bv-plus"><span></span></span>
                            L&#228;gg till ytterligare rum?
                        </a>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
    (function ($) {
        $(function () {

            // this is a function that updates the selected room configurations
            // the function is called when any of the room configurations is updated somehow
            function updateRoomconfigurationsLabel() {

                var nrRooms = parseInt($('#widgetContainer .bv-js-guestpicker-overlay div.bv_js_roomconfig').length);
                var nrGuests = 0;

                $('#widgetContainer .bv-js-SelectedNrAdults').each(function () {
                    nrGuests = nrGuests + parseInt($(this).val());
                });


                $('#widgetContainer .bv-js-SelectedNrChildren').each(function() {
                    nrGuests = nrGuests + parseInt($(this).val());
                });
                var label;
                if ($("#bv-for-single-room").val() == 'True') {
                    if (nrGuests == 1) {
                        label = "1 " + $('#widgetContainer .bv-js-guest').val();
                    } else {
                        label = "" + nrGuests + " " + $('#widgetContainer .bv-js-guests').val();
                    }
                } else {

                    if (nrRooms == 1) {
                        label = "1 " + $('#widgetContainer .bv-js-room').val();
                    } else {
                        label = nrRooms + " " + $('#widgetContainer .bv-js-rooms').val();
                    }
                    if (nrGuests == 1) {
                        label += ", 1 " + $('#widgetContainer .bv-js-guest').val();
                    } else {
                        label += ", " + nrGuests + " " + $('#widgetContainer .bv-js-guests')
                            .val();
                    }
                }

                $('#widgetContainer .bv-js-guestsummary').text(label);
            }

            // this is a function for collapsing the given room config
            function collapseRoomConfig(roomConfToCollapse) {
                $(roomConfToCollapse).addClass("bv-js-room-min");
                var confSummary;
                var noAdults = parseInt($(roomConfToCollapse).find('.bv-js-SelectedNrAdults').val());
                if (noAdults == 1) {
                    confSummary = "1 " + $('#widgetContainer .bv-js-adult-text').val();
                }
                else {
                    confSummary = noAdults + " " + $('#widgetContainer .bv-js-adults-text').val();
                }
                var noChildren = parseInt($(roomConfToCollapse).find('.bv-js-SelectedNrChildren').val());
                if (noChildren > 0) {
                    if (noChildren == 1) {
                        confSummary = confSummary + ", 1 " + $('#widgetContainer .bv-js-child-text').val();
                    } else {

                        confSummary = confSummary + ", " + noChildren + " " + $('#widgetContainer .bv-js-children-text').val();
                    }
                }
                $(roomConfToCollapse).find('.bv-js-conf-summary').text(confSummary);
                $(roomConfToCollapse).find('.bv-js-change-guests').show();
                $(roomConfToCollapse).find('.bv-js-guestgroup').hide();
            }

            // this is a function for displaying a collapsed room config
            function displayRoomConfig(roomConfToDisplay) {
                $(roomConfToDisplay).removeClass("bv-js-room-min");
                $(roomConfToDisplay).find('.bv-js-guestgroup').show();
                $(roomConfToDisplay).find('.bv-js-change-guests').hide();
            }

            // this is a function for collapsing all room configs except
            // the room config given as an inparameter
            function collapseAndDisplayRoomConfigs(roomConToDisplay) {
                if ($(roomConToDisplay).hasClass('bv-js-room-min')) {
                    displayRoomConfig(roomConToDisplay);
                }
                $(roomConToDisplay).siblings('div.bv_js_roomconfig').each(function () {
                    if (!$(this).hasClass('bv-js-room-min')) {
                        collapseRoomConfig(this);
                    }
                });
            }

            function initChildAges(roomConf) {
                var nrChildren = parseInt($(roomConf).find('.bv-js-SelectedNrChildren').val());
                var childages = $(roomConf).find('.bv-js-childages');
                if (nrChildren == 0) {
                    childages.hide();
                    childages.find('.bv-js-childAge').each(function () {
                        $(this).hide();
                    });
                } else {
                    childages.show();
                    var ages = childages.find('.bv-js-childAge');
                    ages.each(function (i) {
                        if (i + 1 <= nrChildren) {
                            $(this).parent().show();
                        } else {
                            $(this).parent().hide();
                            $(this).prop('selectedIndex', 0).change();
                        }
                    });

                    var sharerMaxAge = parseInt($('#widgetContainer .bv-sharer-max-age').val());
                    var sharer = $(roomConf).find('.bv-js-sharer');
                    ages.each(function (i) {
                        if (sharer.length > 0 && parseInt($(this).val()) <= sharerMaxAge) {
                            sharer.show();
                        }
                    });
                }
            }

            // this function makes sure that all ids for input and select fields and their
            // validators are correct, this function is called when a room config has been deleted
            function reassignAttributes() {
                $('#widgetContainer .bv-js-guestpicker-overlay div.bv_js_roomconfig').each(function (idx) {
                    var roomNr = $(this).find('.bv-js-room-no').text();
                    var newVal = roomNr.replace(/\d+/, (idx + 1));
                    $(this).find('.bv-js-room-no').text(newVal);
                    var elem = $(this).find('input, select');
                    elem.each(function () {
                        var thisName = $(this).attr('name');
                        var newName = thisName.replace(/RoomConfigurations\[\d\]+/, 'RoomConfigurations[' + idx + ']');
                        $(this).attr('name', newName);
                    });
                    var elemValid = $(this).find('span.validation_error');
                    elemValid.each(function () {
                        if ($(this).attr('data-valmsg-for')) {
                            var thisName = $(this).attr('data-valmsg-for');
                            var newName = thisName.replace(/RoomConfigurations\[\d\]+/, 'RoomConfigurations[' + idx + ']');
                            $(this).attr('data-valmsg-for', newName);
                        }
                    });
                });
            }

            // this function is called when a user increases the number of
            // adults
            $(document).on('click', '#widgetContainer .bv-js-adult-add', function () {
                var hfSelectedNrAdults = $(this).parent().find('.bv-js-SelectedNrAdults');
                var nrAdults = parseInt(hfSelectedNrAdults.val());
                var maxNrAdults = parseInt($('#widgetContainer .bv-js-max-number-adults').val());

                var newNrAdults = nrAdults + 1;

                if (newNrAdults > maxNrAdults) {
                    return;
                }

                var removeButton = $(this).parent().find('.bv-js-adult-remove');
                removeButton.removeClass('bv-dis');

                if (newNrAdults == maxNrAdults) {
                    $(this).addClass('bv-dis');
                }
                hfSelectedNrAdults.val(newNrAdults);

                var selectedAdultsLabel = $(this).parent().find('.bv-js-selected-adults');
                var newLabel;
                if (newNrAdults == 1) {
                    newLabel = "1 " + $('#widgetContainer .bv-js-adult-text').val();
                } else {
                    newLabel = newNrAdults + " " + $('#widgetContainer .bv-js-adults-text').val();
                }

                selectedAdultsLabel.text(newLabel);
                updateRoomconfigurationsLabel();
            });


            // this fucntion is called when a user reduces the number of
            // adults
            $(document).on('click', '#widgetContainer .bv-js-adult-remove', function () {
                var hfSelectedNrAdults = $(this).parent().find('.bv-js-SelectedNrAdults');
                var nrAdults = parseInt(hfSelectedNrAdults.val());

                var minNrAdults = parseInt($('#widgetContainer .bv-js-min-number-adults').val());

                var newNrAdults = nrAdults - 1;

                if (newNrAdults < minNrAdults) {
                    return;
                }

                var addButton = $(this).parent().find('.bv-js-adult-add');
                addButton.removeClass('bv-dis');

                if (newNrAdults == minNrAdults) {
                    $(this).addClass('bv-dis');
                }
                hfSelectedNrAdults.val(newNrAdults);

                var selectedAdultsLabel = $(this).parent().find('.bv-js-selected-adults');
                var newLabel;
                if (newNrAdults == 1) {
                    newLabel = "1 " + $('#widgetContainer .bv-js-adult-text').val();
                } else {
                    newLabel = newNrAdults + " " + $('#widgetContainer .bv-js-adults-text').val();
                }

                selectedAdultsLabel.text(newLabel);
                updateRoomconfigurationsLabel();
            });

            // this function is trigged when a user increases the number of
            // children, the function makes sure that the correct number of
            // child age drop downs are displayed
            $(document).on('click', '#widgetContainer .bv-js-child-add', function () {
                var hfSelectedNrChildren = $(this).parent().find('.bv-js-SelectedNrChildren');
                var nrChildren = parseInt(hfSelectedNrChildren.val());

                var maxNrChildren = parseInt($('#widgetContainer .bv-js-max-number-children').val());

                var newNrChildren = nrChildren + 1;

                if (newNrChildren > maxNrChildren) {
                    return;
                }

                var removeButton = $(this).parent().find('.bv-js-child-remove');
                removeButton.removeClass('bv-dis');

                if (newNrChildren == maxNrChildren) {
                    $(this).addClass('bv-dis');
                }
                hfSelectedNrChildren.val(newNrChildren);

                var yearspan = $('#widgetContainer .bv-js-children-year-span').val();
                var selectedChildrenLabel = $(this).parent().find('.bv-js-selected-children');
                var newLabel;
                if (newNrChildren == 1) {
                    newLabel = "1 " + $('#widgetContainer .bv-js-child-text').val() + " " + yearspan;
                } else {
                    newLabel = newNrChildren + " " + $('#widgetContainer .bv-js-children-text').val() + " " + yearspan;
                }
                selectedChildrenLabel.text(newLabel);

                var childages = $(this).closest('.bv-js-guestgroup').find('.bv-js-childages');

                if (newNrChildren == 0) {
                    childages.hide();
                    childages.find('.bv-js-childAge').each(function () {
                        $(this).hide();
                    });
                } else {
                    childages.show();
                    childages.find('.bv-js-childAge').each(function (i) {
                        if (i + 1 <= newNrChildren) {
                            $(this).parent().show();
                        } else {
                            $(this).parent().hide();
                            $(this).prop('selectedIndex', 0).change();
                        }
                    });
                }
                updateRoomconfigurationsLabel();
            });

            // this function is trigged when a user reduces the number of
            // children, the function makes sure that the correct number
            // of child age drop downs are displayed and makes sure that
            // the sharer checkbox is hidden if the ages of the remaining
            // child ages are greater than the max sharer age
            $(document).on('click', '#widgetContainer .bv-js-child-remove', function () {
                var hfSelectedNrChildren = $(this).parent().find('.bv-js-SelectedNrChildren');
                var nrChildren = parseInt(hfSelectedNrChildren.val());
                var minNrChildren = 0;

                var newNrChildren = nrChildren - 1;
                if (newNrChildren < minNrChildren) {
                    return;
                }

                var addButton = $(this).parent().find('.bv-js-child-add');
                addButton.removeClass('bv-dis');

                if (newNrChildren == minNrChildren) {
                    $(this).addClass('bv-dis');
                }
                hfSelectedNrChildren.val(newNrChildren);
                var yearspan = $('#widgetContainer .bv-js-children-year-span').val();
                var selectedChildrenLabel = $(this).parent().find('.bv-js-selected-children');
                var newLabel;
                if (newNrChildren == 1) {
                    newLabel = "1 " + $('#widgetContainer .bv-js-child-text').val() + " " + yearspan;
                } else {
                    newLabel = newNrChildren + " " + $('#widgetContainer .bv-js-children-text').val() + " " + yearspan;
                }
                selectedChildrenLabel.text(newLabel);

                var childages = $(this).closest('.bv-js-guestgroup').find('.bv-js-childages');

                if (newNrChildren == 0) {
                    childages.hide();
                    childages.find('.bv-js-childAge').each(function () {
                        $(this).hide();
                    });
                } else {
                    childages.show();
                    childages.find('.bv-js-childAge').each(function (i) {
                        if (i + 1 <= newNrChildren) {
                            $(this).parent().show();
                        } else {
                            $(this).parent().hide();
                            $(this).prop('selectedIndex', 0).change();
                        }
                    });
                }
                updateRoomconfigurationsLabel();
            });

            // this function is trigged when a user changes the value of the
            // child age drop down, the function checks if the sharer checkbox
            // should be visible or hidden
            $(document).on('change', '#widgetContainer .bv-js-childAge', function () {
                $(this).parent().find('span').first().text($("option:selected", this).text());
                var sharer = $(this).closest('.bv-js-guestgroup').find('.bv-js-sharer');
                if (sharer.length > 0) {
                    var sharerMaxAge = parseInt($('#widgetContainer .bv-js-sharer-max-age').val());
                    var ages = $(this).closest('.bv-js-childages').find('.bv-js-childAge');
                    sharer.hide();
                    ages.each(function() {
                        if ($(this).is(':visible') && parseInt($(this).val()) <= sharerMaxAge) {
                            sharer.show();
                        }
                    });
                }
            });

            // this function is trigged when a user clicks on the link "Add an additional room"
            // the function adds a new room config and makes sure that previous room configs
            // are collapsed
            $(document).on('click', '#widgetContainer .bv-js-add-room', function () {
                var nrRooms = $('#widgetContainer .bv-js-guestpicker-overlay div.bv_js_roomconfig').length;
                var roomConfMarkup = $('#widgetContainer .bv-js-guestpicker-overlay div.bv_js_roomconfig:eq(0)');
                // display the remove button
                if (nrRooms == 1) {
                    $(roomConfMarkup).find('a.bv-js-remove').show();
                }

                var lastRoomConf = $('#widgetContainer .bv-js-guestpicker-overlay div.bv_js_roomconfig').last();
                var cloneConf = roomConfMarkup.clone();
                // make sure that the cloned room config isn't displayed in a collapsed mode
                $(cloneConf).find('.bv-js-change-guests').hide();
                $(cloneConf).removeClass("bv-js-room-min");
                $(cloneConf).find('.bv-js-guestgroup').show();
                $(cloneConf).find('.bv-js-childages').hide();
                $(cloneConf).find('.bv-js-childAge').each(function () {

                    $(this).parent().hide();
                    $(this).prop('selectedIndex', 0);
                    $(this).parent().find('span').first().text($("option:selected", this).text());
                });

                var yearspan = $('#widgetContainer .bv-js-children-year-span').val();
                var selectedChildrenLabel = $(cloneConf).find('.bv-js-selected-children');
                var newLabel = "0 " + $('#widgetContainer .bv-js-children-text').val() + " " + yearspan;
                selectedChildrenLabel.text(newLabel);
                $(cloneConf).find('.bv-js-SelectedNrChildren').val(0);
                var sharer = $(cloneConf).find('.bv-js-sharer');
                if (sharer.length > 0) {
                    sharer.hide();
                }
                var newSharerId = "bv-js-sharer-" + parseInt(nrRooms);
                sharer.find('.bv-js-include-sharer').attr('id', newSharerId);
                sharer.find('.bv-js-sharer-label').attr('for', newSharerId);

                $(cloneConf).find('.bv-js-child-remove').addClass('bv-dis');
                if (parseInt($('#widgetContainer .bv-js-max-number-children').val()) > 0) {
                    $(cloneConf).find('.bv-js-child-add').removeClass('bv-dis');
                }

                var defaultNrAdults = parseInt($('#widgetContainer .bv-js-default-nr-adults').val());
                $(cloneConf).find('.bv-js-SelectedNrAdults').val(defaultNrAdults);
                var selectedAdultsLabel = $(cloneConf).find('.bv-js-selected-adults');
                var newAdultLabel = defaultNrAdults + " " + $('#widgetContainer .bv-js-adults-text').val();
                selectedAdultsLabel.text(newAdultLabel);


                if (parseInt($('#widgetContainer .bv-js-min-number-adults').val()) < defaultNrAdults) {
                    $(cloneConf).find('.bv-js-adult-remove').removeClass('bv-dis');
                } else {
                    $(cloneConf).find('.bv-js-adult-remove').addClass('bv-dis');
                }
                if (parseInt($('#widgetContainer .bv-js-max-number-adults').val()) > defaultNrAdults) {
                    $(cloneConf).find('.bv-js-adult-add').removeClass('bv-dis');
                } else {
                    $(cloneConf).find('.bv-js-adult-add').addClass('bv-dis');
                }

                var roomNr = $(cloneConf).find('.bv-js-room-no').text();
                var newVal = roomNr.replace(/\d+/, (parseInt(nrRooms) + 1));
                $(cloneConf).find('.bv-js-room-no').text(newVal);

                // get all inputs, selects in clone
                var elem = cloneConf.find('input, select');
                // set new name attribute for each element
                elem.each(function () {
                    var thisName = $(this).attr('name');
                    var newName = thisName.replace(/RoomConfigurations\[0\]/, 'RoomConfigurations[' + nrRooms + ']');
                    $(this).attr('name', newName);
                });

                // get all validation span elements in clone
                var elemValid = cloneConf.find('span.validation_error');
                // set new for attribute for each element
                elemValid.each(function () {
                    if ($(this).attr('data-valmsg-for')) {
                        var thisName = $(this).attr('data-valmsg-for');
                        var newName = thisName.replace(/RoomConfigurations\[0\]/, 'RoomConfigurations[' + nrRooms + ']');
                        $(this).attr('data-valmsg-for', newName);
                    }
                });

                // insert the clone at the bottom
                cloneConf.insertAfter(lastRoomConf);

                // collapse all room configs except the last added
                collapseAndDisplayRoomConfigs(cloneConf);

                updateRoomconfigurationsLabel();
            });


            var rooms = $('#widgetContainer .bv-js-guestpicker-overlay div.bv_js_roomconfig');
            if (rooms.length > 1) {
                // Add remove buttons
                rooms.find('a.bv-js-remove').show();
                collapseAndDisplayRoomConfigs(rooms.last());
                initChildAges(rooms.last());
            }

            // this function is trigged when a user clicks on the
            // change guests row on a collapsed room config
            $(document).on('click', '#widgetContainer .bv-js-change-guests', function () {
                var thisRoomConf = $(this).closest('div.bv_js_roomconfig');
                collapseAndDisplayRoomConfigs(thisRoomConf);
            });

            // this function is trigged when a user clicks on the remove button
            // the function removes the room config associated with the button
            // and makes sure that the last room in the room config list is displayed
            $(document).on('click', '#widgetContainer .bv-js-remove', function (e) {
                e.preventDefault();
                $(this).closest('div.bv_js_roomconfig').remove();
                reassignAttributes();

                var nrRooms = $('#widgetContainer .bv-js-guestpicker-overlay div.bv_js_roomconfig').length;

                if (nrRooms == 1) {
                    var firstRoom = $('#widgetContainer .bv-js-guestpicker-overlay div.bv_js_roomconfig:eq(0)');
                    $(firstRoom).find('a.bv-js-remove').hide();
                }

                var lastRoom = $('#widgetContainer .bv-js-guestpicker-overlay div.bv_js_roomconfig').last();
                collapseAndDisplayRoomConfigs(lastRoom);
                updateRoomconfigurationsLabel();
            });

            $(document).mouseup(function (e) {
                var container = $('#widgetContainer .bv-js-guestpicker-overlay');

                $('#widgetContainer .bv-js-guestpicker-input').on("click", function (el) {
                    container.show();
                    $("html").addClass("bv-widget-noscroll-small-device");
                });

                if (!container.is(e.target) && container.has(e.target).length === 0) {
                    container.hide();
                    var datepickerContainer = $('#widgetContainer .bv-js-datepicker-overlay');
                    var codeContainer = $('#widgetContainer .bv-js-codepicker-overlay');
                    if ((typeof datepickerContainer === 'undefined' || datepickerContainer.css('display') === 'none') &&
                        (typeof codeContainer === 'undefined' || codeContainer.css('display') === 'none')) {
                        $("html").removeClass("bv-widget-noscroll-small-device");
                    }
                }
            });

            $(document).on("click", '#widgetContainer .bv-js-guestpicker-close', function () {
                $('#widgetContainer .bv-js-guestpicker-overlay').hide();
                $("html").removeClass("bv-widget-noscroll-small-device");
            });


            $('#widgetContainer select.bv-gui-select').simpleSelect();

        });
    })(bvJQuery);
</script>    <!-- extra -->
    <div class="bv-item bv-item-code">
        <div class="bv-lbl-title">Rabatt- eller reseagentkod?</div>


            <label class="bv-gui-text cb-js-codepicker-trigger" id="bv-code" style="cursor: pointer;">
                <span>Jag har en kod</span>
                <i class="bv-input-icn bv-icn-key"><i></i><i></i></i>
            </label>
        <div class="bv-formpicker bv-js-codepicker-overlay" style="display: none;">
            <div class="bv-formpicker-inner">
                <div class="bv-picker-title">
                    <h3>Har du en rabattkod?</h3>
                    <div class="bv-close bv-js-codepicker-close">
                        <div class="bv-gui-btn">St&#228;ng</div>
                    </div>
                </div>
                <div class="bv-picker-overflow">
                    <p>Ange din rabattkod och klicka &quot;Verifiera kod&quot;.</p>
                        <label>
                            <input class="bv-gui-text bv-js-promo bv-js-promo" data-val="true" data-val-length="Max antal tecken är {0}" data-val-length-max="50" id="PromoCode" name="PromoCode" placeholder="Rabattkod" type="text" value="" />
                            <span class="field-validation-valid validation_error2" data-valmsg-for="PromoCode" data-valmsg-replace="true"></span>
                            <i></i>
                        </label>
                                                            <button type="button" class="bv-gui-btn bv-js-verifycodebutton">Verifiera kod</button>
                    <span class="validation_error2 field-validation-error bv-js-verifycodeerror" style="display: none;color: red;">
                        <span class="bv-js-verifycodeerrormessage"></span>
                    </span>
                </div>
            </div>
        </div>
        <script type="text/javascript">
            (function ($) {

                $('#widgetContainer .bv-js-verifycodebutton').click(function () {

                    var url = 'https://online.bookvisit.com/Reservation/SubmitCodeJsonP';

                    var promocode = $('#widgetContainer .bv-js-promo').val();
                    var corpcode = $('#widgetContainer .bv-js-corp').val();
                    var iatacode = $('#widgetContainer .bv-js-iata').val();
                    var channelid = '56b734f3-8829-40af-927e-9f27f2cf7f37';

                    promocode = encodeURIComponent(promocode);
                    corpcode = encodeURIComponent(corpcode);
                    iatacode = encodeURIComponent(iatacode);

                    url += "?jsoncallback=?&channelId=" + channelid;

                    if (promocode != '' && $('#widgetContainer .bv-js-promo').val() != undefined) {
                        url += "&promoCode=" + promocode;
                    }

                    if (corpcode != '' && $('#widgetContainer .bv-js-corp').val() != undefined) {
                        url += "&corpCode=" + corpcode;
                    }

                    if (iatacode != '' && $('#widgetContainer .bv-js-iata').val() != undefined) {
                        url += "&iataCode=" + iatacode;
                    }

                    $.getJSON(url, function (data) {
                        if (data.Status == "success") {
                            $('#widgetContainer .bv-js-codepicker-overlay').hide();
                            //update the "i have a code" text and css class for display purpose
                            var codes = [];
                            if (promocode && promocode != "undefined") {
                                codes.push(promocode);
                            }

                            if (corpcode && corpcode != "undefined") {
                                codes.push(corpcode);
                            }

                            if (iatacode && iatacode != "undefined") {
                                codes.push(iatacode);
                            }

                            if (codes.length > 0) {
                                var displayCode = codes.join(" / ");
                                displayCode = decodeURIComponent(displayCode);
                                $("#bv-code span").text(displayCode);
                                $("#bv-code").addClass("bv-code-valid");
                            }
                        } else {
                            $('#widgetContainer .bv-js-verifycodeerrormessage').text(data.ErrorMessage);
                            $('#widgetContainer .bv-js-verifycodeerror').show();
                        }
                    });
                });


                // open widget codepicker
                $(document).mouseup(function (e) {

                    var container = $('#widgetContainer .bv-js-codepicker-overlay');
                    $(document).on("click", '#widgetContainer .cb-js-codepicker-trigger', function () {
                        $(this).siblings(".bv-js-codepicker-overlay").show();
                        $("html").addClass("bv-widget-noscroll-small-device");
                    });
                    if (!container.is(e.target) && container.has(e.target).length === 0) {
                        container.hide();
                        var guestPickerContainer = $('#widgetContainer .bv-js-guestpicker-overlay');
                        var datepickerContainer = $('#widgetContainer .bv-js-datepicker-overlay');
                        if ((typeof guestPickerContainer === 'undefined' || guestPickerContainer.css('display') === 'none') &&
                            (typeof datepickerContainer === 'undefined' || datepickerContainer.css('display') === 'none')) {
                            $("html").removeClass("bv-widget-noscroll-small-device");
                        }
                    }
                });

                $(document).on("click", '#widgetContainer .bv-js-codepicker-close', function () {
                    $('#widgetContainer .bv-js-codepicker-overlay').hide();
                    $("html").removeClass("bv-widget-noscroll-small-device");
                });

            })(bvJQuery);
        </script>
    </div>

                    <div class="bv-item bv-item-search">
    <span class="bv-float-msg bv-js-date-error" style="display: none;">
        <span style="display: block;">
            V&#228;lj ett datum i kalendern
            <span class="bv-close bv-js-date-error-close"></span>
        </span>
    </span>

    <span class="bv-float-msg bv-js-roomconf-error" style="display: none;">
        <span style="display: block;">
            V&#229;rt st&#246;rsta rum till&#229;ter max 3 g&#228;ster. V&#228;nligen dela upp ert reses&#228;llskap i flera rum och s&#246;k igen!
            <span class="bv-close bv-js-roomconf-error-close"></span>
        </span>
    </span>

    <div class="bv-lbl-title">&nbsp;</div>
    <a href="javascript: void(0);" class="bv-gui-btn bv-js-widget-button">
        S&#246;k
    </a>
</div>



                </div>
            </div>

        </div>
    </div>

<script>
    (function ($) {
        var isLargeWidget = "False";

         //For widget popup positioning while scroll window
        function repositionPopUp() {
            $('.bv-widget .bv-item-date').each(function() {
                var offset = $(this).offset();
                var position = (offset.top - $(window).scrollTop());
                var height = $(window).height();
                repostionDatePopUp(position, height, $(this));
            });

            if (isLargeWidget === "False") {
                $('.bv-widget .bv-item-guests').each(function() {
                    var offset = $(this).offset();
                    var position = (offset.top - $(window).scrollTop());
                    var height = $(window).height();
                    repostionGuestPopUp(position, height, $(this));
                });

                $('.bv-widget .bv-item-code').each(function() {
                    var offset = $(this).offset();
                    var position = (offset.top - $(window).scrollTop());
                    var height = $(window).height();
                    repostionCodePopUp(position, height, $(this));
                });
            }
        }

        $(window).scroll(function() {
            repositionPopUp();
        });

        // For the first time loading widget
        repositionPopUp();

        function repostionDatePopUp(position, height, widget) {
            if (isLargeWidget === "False") {
                if (height - position < height / 2) {
                    var bottomOffset = widget.find(".bv-js-datepicker-input:first").height();
                    widget.find('.bv-datepicker:first').css('bottom', bottomOffset);
                } else {
                    widget.find('.bv-datepicker:first').css('bottom', '');
                }
            }

            // make it a little bit higher for stay length picker
            if (height - position < 500) {
                widget.find('.bv-datepicker:first').addClass("bv-period-opentop");
            } else {
                widget.find('.bv-datepicker:first').removeClass("bv-period-opentop");
            }
        }

        function repostionGuestPopUp(position, height, widget) {
            if (height - position < height / 2) {
                var bottomOffset = widget.find(".bv-js-guestpicker-input:first").height();
                widget.find('.bv-guestpicker:first').css('bottom', bottomOffset);
            } else {
                widget.find('.bv-guestpicker:first').css('bottom', '');
            }
        }

        function repostionCodePopUp(position, height, widget) {
            if (height - position < height / 2) {
                var bottomOffset = widget.find(".cb-js-codepicker-trigger:first").height();
                widget.find('.bv-formpicker:first').css('bottom', bottomOffset);
            } else {
                widget.find('.bv-formpicker:first').css('bottom', '');
            }
        }

    })(bvJQuery);
</script>
<script>
    (function ($) {
         var openOption = "Redirect";
         $(document).on("click",
            '#widgetContainer #bv-js-login',
            function() {
                var baseUrl = 'https://online.bookvisit.com/my-page/login';
                var channelId = $('#widgetContainer .bv-js-channelid').val();
                var url = baseUrl + '?channelId=' + channelId;
                var culture = 'sv-SE';

                url += '&culture=' + culture;

                var linkerUrl = url;
                    
                        try {
                            var tracker = ga.getAll()[0];
                            window.linker = window.linker || new window.gaplugins.Linker(tracker);
                            linkerUrl = window.linker.decorate(url, '');
                        } catch (err) {
                        }
                    

                if (window.screen.width <= 1024) {
                    openOption = 'Redirect';
                }

                if (openOption.toUpperCase() === "NewWindow".toUpperCase() || openOption.toUpperCase() === "iframe".toUpperCase()) {
                    window.open(linkerUrl);
                } else if (openOption.toUpperCase() === "Redirect".toUpperCase()) {
                    window.location = linkerUrl;
                } else {
                    window.open(linkerUrl);
                }
            });
    })(bvJQuery);
</script>
    <script>
    (function($) {
        var isExtraWidget = "False";

        $(document).on("click",
            '#widgetContainer .bv-js-roomconf-error-close',
            function() {
                $('#widgetContainer .bv-js-roomconf-error').hide();
            });

        $(document).on("click",
            '#widgetContainer .bv-js-date-error-close',
            function() {
                $('#widgetContainer .bv-js-date-error').hide();
            });

        var widgetContainerId = "#widgetContainer";
        var widgetContainer = $(widgetContainerId);
        var hasLayout = "True";
        if (hasLayout === "True") {
            var divClass = "bv-" + "StandardWide";
            widgetContainer.addClass(divClass);
        }

        if (!
            $("link[href='https://online.bookvisit.com/Content/flexwidget/css/FlexWidgetFullCss.css']").length) {
            $('<link href="https://online.bookvisit.com/Content/flexwidget/css/FlexWidgetFullCss.css" rel="stylesheet">')
                .appendTo("head");
        }

        function validateRoomConfigs(roomConfigs) {
            var isValid = true;
            var maxOccupancy = parseInt('3');

            roomConfigs.each(function() {
                var nrChildren = parseInt($(this).find('.bv-js-SelectedNrChildren').val());
                var nrAdults = parseInt($(this).find('.bv-js-SelectedNrAdults').val());
                var sharer = $(this).find('.bv-js-include-sharer');
                if (sharer.length > 0 && sharer.is(':checked') && nrChildren > 0) {
                    nrChildren = nrChildren - 1;
                }
                if (nrAdults + nrChildren > maxOccupancy) {
                    isValid = false;
                }
            });

            return isValid;
        }

        var openOption = "Redirect";


        $(document).on('click',
            '#widgetContainer .bv-js-widget-button',
            function() {
                var searchPanel = $($.find('#widgetContainer .bv-js-search-container'));
                var alternativeRedirectUrl = '';
                var channelId = $('#widgetContainer .bv-js-channelid').val();
                var promoCode = '';
                var corpCode = '';
                var iataCode = '';
                var year = $('#widgetContainer .bv-js-arrvial-date-year').val();
                var month = $('#widgetContainer .bv-js-arrvial-date-month').val();
                var day = $('#widgetContainer .bv-js-arrvial-date-day').val();
                var stayLength = $('#widgetContainer .bv-js-stay-length').val();
                var roomConf = '';
                var guestRoomId = '';
                var packageId = '';
                var packageCategoryId = '';
                var isMultiPropertyPackageCategory = '';
                var campaignId = '';
                var allPackages = 'False';
                var geoNodeId = '';
                var culture = 'sv-SE';
                var currency = 'SEK';

                if ($('#widgetContainer .bv-js-geoNode').length > 0) {
                    geoNodeId = $('#widgetContainer .bv-js-geoNode').val();
                }

                if (isExtraWidget === "False") {

                    var promoContainer = searchPanel.find(".bv-js-promo");
                    if (promoContainer.length > 0) {
                        promoCode = promoContainer.val();

                        promoCode = encodeURIComponent(promoCode);
                    }

                    var corpContainer = searchPanel.find(".bv-js-corp");
                    if (corpContainer.length > 0) {
                        corpCode = corpContainer.val();

                        corpCode = encodeURIComponent(corpCode);
                    }

                    var iataContainer = searchPanel.find(".bv-js-iata");
                    if (iataContainer.length > 0) {
                        iataCode = iataContainer.val();

                        iataCode = encodeURIComponent(iataCode);
                    }

                    var sharerMaxAgePanel = searchPanel.find(".bv-js-sharer-max-age");
                    var sharerMaxAge = parseInt(sharerMaxAgePanel.val());

                    var roomConfigs = searchPanel.find(".bv-js-guestpicker-overlay div.bv_js_roomconfig");
                    if (roomConfigs.length > 0) {
                        roomConfigs.each(function () {
                            var nrChildren = parseInt($(this).find('.bv-js-SelectedNrChildren').val());
                            var nrAdults = parseInt($(this).find('.bv-js-SelectedNrAdults').val());
                            if (roomConf.length > 0) {
                                roomConf += '|';
                            }
                            roomConf += 'a' + nrAdults;
                            var sharerAge = -1;
                            var sharer = $(this).find('.bv-js-include-sharer');

                            $(this).find('.bv-js-childAge').each(function (i) {
                                if (i < nrChildren) {
                                    var age = $(this).val();
                                    if (age != "") {
                                        var cAge = parseInt(age);
                                        var childAgeAlreadyAdded = false;
                                        if (cAge <= sharerMaxAge && sharerAge === -1) {
                                            if (sharer.length > 0 && sharer.is(':checked')) {
                                                childAgeAlreadyAdded = true;
                                                sharerAge = cAge;
                                            }
                                        }
                                        if (childAgeAlreadyAdded == false) {
                                            roomConf += '_c' + cAge;
                                        }
                                    }
                                }
                            });
                            if (sharerAge > -1) {
                                roomConf += '_s' + sharerAge;
                            }
                        });

                        var errorPanel = searchPanel.find(".bv-js-date-error");
                        if (roomConf === "") {
                            $(errorPanel).show();
                            setTimeout(function () {
                                $(errorPanel).fadeOut('slow');
                            },
                                5000);
                            return;
                        }
                        if (!validateRoomConfigs(roomConfigs)) {
                            var roomConfErrorPanel = searchPanel.find(".bv-js-roomconf-error");
                            $(roomConfErrorPanel).show();
                            setTimeout(function () {
                                $(roomConfErrorPanel).fadeOut('slow');
                            },
                                5000);
                            return;
                        }
                    }

                }

                var baseUrl = 'https://online.bookvisit.com/v2/widget/WidgetNewWindowStart';
                var url;
                if (isExtraWidget === "False") {
                    url = baseUrl + '?channelId=' + channelId;
                    url += '&year=' + year + '&month=' + month + '&day=' + day;
                    url += '&stayLength=' + stayLength + '&roomConfig=' + roomConf + '&promoCode=' + promoCode;
                    url += '&corpCode=' + corpCode + '&iataCode=' + iataCode + '&guestRoomId=' + guestRoomId;
                    url += '&packageId=' +
                        packageId +
                        '&packageCategoryId=' +
                        packageCategoryId +
                        '&campaignId=' +
                        campaignId +
                        '&allPackages=' +
                        allPackages +
                        '&isMultiPropertyPackageCategory=' +
                        isMultiPropertyPackageCategory +
                        '&geoNodeId=' +
                        geoNodeId +
                        '&forExtras=false';

                    url += '&culture=' + culture;
                    if (currency !== '') {
                        url += '&currency=' + currency;
                    }
                } else {
                    url = baseUrl + '?channelId=' + channelId;
                    url += '&year=' + year + '&month=' + month + '&day=' + day;
                    url += '&stayLength=' + stayLength;
                    url += '&culture=' + culture +
                        '&forExtras=true';
                    if (currency !== '') {
                        url += '&currency=' + currency;
                    }
                }

                var linkerUrl = url;
                var tracker;
                        
                            try {
                                tracker = ga.getAll()[0];
                                window.linker = window.linker || new window.gaplugins.Linker(tracker);
                                linkerUrl = window.linker.decorate(url, '');
                            }
                            catch (err) {
                            }
                        
                if (openOption.toUpperCase() === "NewWindow".toUpperCase() || openOption.toUpperCase() === "iframe".toUpperCase()) {
                    window.open(linkerUrl);
                }
                else {
                    if (window.screen.width <= 1024) {
                        openOption = 'Redirect';
                    }
                    if (openOption.toUpperCase() === "Redirect".toUpperCase()) {
                        if (alternativeRedirectUrl == null || alternativeRedirectUrl == '') {
                            window.location = linkerUrl;
                        } else {
                            window.location = alternativeRedirectUrl;
                        }
                    } else {
                        window.open(linkerUrl);
                    }
                }
            });

    })(bvJQuery);
    </script>